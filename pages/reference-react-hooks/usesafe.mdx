import { Tabs } from "nextra/components";

# `useSafe`

This is the primary hook for accessing safe-related information. It provides a set of utilities to interact with the safe, allowing actions such as connecting and disconnecting signers, retrieving balances, and obtaining information about the connected chain, among others.

## Usage

{/* <!-- vale off --> */}

<Tabs items={['App.tsx', 'main.tsx']}>
  <Tabs.Tab>
  ```typescript
  import { useSafe } from '@safe-global/safe-core-sdk-react-hooks'
  
  function App() {
    const { isInitialized, getBalance } = useSafe()
    const { data } = getBalance()

    if (!isInitialized) {
      return <p>Safe SDK is not initialized</p>
    }

    return (
      <div>
        <h1>Safe App</h1>
        <pre>{JSON.stringify(data, null, 2)}</pre>
      </div>
    )
  }
  ```
</Tabs.Tab>
<Tabs.Tab>
  ```typescript
  import ReactDOM from 'react-dom/client'
  import { createConfig, SafeProvider } from '@safe-global/safe-core-sdk-react-hooks'
  import App from './App.tsx  '

  const config = createConfig({
    chain,
    provider,
    signer,
    safeOptions: {
      owners,
      threshold
    }
  })

  ReactDOM.createRoot(document.getElementById('root')!).render(
    <SafeProvider config={config}>
      <App />
    </SafeProvider>
  )
  ```
</Tabs.Tab>
</Tabs>

{/* <!-- vale on --> */}

## Returns

### `isInitialized`

`boolean`

Indicates whether the Safe SDK is `isInitialized` and ready for use. Always check this before interacting with the Safe.

### `isSignerConnected`

`boolean`

Indicates whether the signer is connected. Check this before using any method that requires a signer, such as sending transactions or signing messages.

### `connect`

`(signer: string) => Promise<void>`

Connects the specified signer.

#### Parameters

- `signer` (string): The address of the signer to connect.

{/* <!-- vale off --> */}

```typescript
import React from 'react';
import { useSafe } from '@safe-global/safe-core-sdk-react-hooks';

const Connect = () => {
  const { connect } = useSafe();

  return (
    <div>
      <h3>Chain Info</h3>
      <button onClick={() => connect("0xSignerAddress")}></button>
    </div>
  );
};

export default Connect;
```

{/* <!-- vale on --> */}

### `disconnect`

`() => Promise<void>`

Disconnects the current connected signer.

{/* <!-- vale off --> */}

```typescript
import React from 'react';
import { useSafe } from '@safe-global/safe-core-sdk-react-hooks';

const Disconnect = () => {
  const { disconnect } = useSafe();

  return (
    <div>
      <h3>Chain Info</h3>
      <button onClick={disconnect}></button>
    </div>
  );
};

export default Disconnect;
```

{/* <!-- vale on --> */}

### `getBalance`

`(params?: UseBalanceParams) => UseBalanceReturnType`

Retrieves the balance information of the Safe.

#### Parameters
- `params` (UseBalanceParams, optional): Parameters to customize the hook behavior. It contains:
  - `config` (SafeConfig, optional): The [`SafeConfig`](./safeconfig.mdx) is used when a `SafeProvider` is not present in the component tree.

#### Returns
- A [query result](https://tanstack.com/query/v5/docs/framework/react/reference/useQuery) object containing the Safe balance in the `data` property.
- We are using the wagmi [`UseBalanceReturnType`](https://wagmi.sh/react/api/hooks/useBalance#return-type)

#### Usage
{/* <!-- vale off --> */}

```typescript
import React from 'react';
import { useSafe } from '@safe-global/safe-core-sdk-react-hooks';

const SafeBalance = () => {
  const { getBalance } = useSafe();
  const { data, error, isLoading } = getBalance();

  if (isLoading) return <p>Loading...</p>;
  if (error) return <p>Error: {error.message}</p>;

  return (
    <div>
      <h3>Safe Balance</h3>
      <pre>{JSON.stringify(data, null, 2)}</pre>
    </div>
  );
};

export default SafeBalance;
```

{/* <!-- vale on --> */}

### `getChain`

`(params: UseChainParams = {}) => UseChainReturnType`

Get the chain information of the Safe. 

#### Parameters
- `params` (UseChainParams, optional): Parameters to customize the hook behavior. It contains:
  - `config` (SafeConfig, optional): The [`SafeConfig`](./safeconfig.mdx) is used when a `SafeProvider` is not present in the component tree.

#### Returns
- It returns `UseChainReturnType = SafeConfig['chain']` being `SafeConfig['chain']` the viem's [Chain Type](https://github.com/wevm/viem/blob/main/src/types/chain.ts).

#### Usage

{/* <!-- vale off --> */}

```typescript
import React from 'react';
import { useSafe } from '@safe-global/safe-core-sdk-react-hooks';

const ChainInfo = () => {
  const { getChain } = useSafe();
  const { blockExplorers } = getChain()

  return (
    <div>
      <h3>Chain Info</h3>
      <pre>{JSON.stringify(blockExplorers, null, 2)}</pre>
    </div>
  );
};

export default ChainInfo;
```

{/* <!-- vale on --> */}

### `getPendingTransactions`

`(params?: UsePendingTransactionsParams) => UsePendingTransactionsReturnType`

Get all pending transactions for the connected Safe.

#### Parameters
- `params` (UsePendingTransactionsParams, optional): Parameters to customize the hook behavior. It contains:
  - `config` (SafeConfig, optional): The [`SafeConfig`](./safeconfig.mdx) is used when a `SafeProvider` is not present in the component tree.

#### Returns
- A [query result](https://tanstack.com/query/v5/docs/framework/react/reference/useQuery) object containing the pending transactions in the `data` property.
- The `data` property type is `SafeMultisigTransaction[]` and contains the [transaction information](https://github.com/safe-global/safe-core-sdk/blob/dc602ed126cc210048b278b2372c0979ee4be62b/packages/types-kit/src/types.ts#L216C1-L247C2) extracted from the Transaction Service.

{/* <!-- vale off --> */}

```typescript
import React from 'react';
import { useSafe } from '@safe-global/safe-core-sdk-react-hooks';

const PendingTransactions = () => {
  const { getPendingTransactions } = useSafe();
  const { data, error, isLoading } = getPendingTransactions();

  if (isLoading) return <p>Loading...</p>;
  if (error) return <p>Error: {error.message}</p>;

  return (
    <div>
      <h3>Pending Transactions</h3>
      <pre>{JSON.stringify(data, null, 2)}</pre>
    </div>
  );
};

export default PendingTransactions;
```

{/* <!-- vale on --> */}

### `getTransaction`

`<Params extends UseTransactionParams>(params: Params) => UseTransactionReturnType<Params>`

Get an specific transaction.

#### Parameters
- `params` (UseTransactionParams): Parameters to customize the hook behavior. It contains:
  - `config` (SafeConfig, optional): The [`SafeConfig`](./safeconfig.mdx) is used when a `SafeProvider` is not present in the component tree.
  - `safeTxHash` (Hash, optional): Hash of the Safe transaction to be fetched. Either `safeTxHash` or `ethereumTxHash` must be provided.
  - `ethereumTxHash` (Hash, optional): Hash of the Ethereum transaction to be fetched. Either `safeTxHash` or `ethereumTxHash` must be provided.

#### Returns
- A [query result](https://tanstack.com/query/v5/docs/framework/react/reference/useQuery) object containing the transaction in the `data` property. The type of the return value depends on whether `safeTxHash` or `ethereumTxHash` are provided:
  - If `safeTxHash` is provided, it returns a query result containing the [transaction](https://github.com/safe-global/safe-core-sdk/blob/dc602ed126cc210048b278b2372c0979ee4be62b/packages/types-kit/src/types.ts#L216C1-L247C2).
  - If `ethereumTxHash` is provided, it returns [`UseTransactionReturnTypeWagmi`](https://wagmi.sh/react/api/hooks/useTransaction).

#### Usage
{/* <!-- vale off --> */}

```typescript
import React from 'react';
import { useSafe } from '@safe-global/safe-core-sdk-react-hooks';

const TransactionStatus = ({ safeTxHash, /* ethereumTxHash */ }) => {
  const { getTransaction } = useSafe();
  const { data, error, isLoading } = getTransaction({
    safeTxHash,
    // ...or ethereumTxHash,
  });

  if (isLoading) return <p>Loading...</p>;
  if (error) return <p>Error: {error.message}</p>;

  return (
    <div>
      <h3>Transaction Status</h3>
      <pre>{JSON.stringify(data, null, 2)}</pre>
    </div>
  );
};

export default TransactionStatus;
```

{/* <!-- vale on --> */}

### `getTransactions`

`(params: UseTransactionsParams = {}) => UseTransactionsReturnType`

Get all transactions for the connected Safe.

#### Parameters
- `params` (UseTransactionsParams, optional): Parameters to customize the hook behavior. It contains:
  - `config` (SafeConfig, optional): The [`SafeConfig`](./safeconfig.mdx) is used when a `SafeProvider` is not present in the component tree.

#### Returns
- A [query](https://tanstack.com/query/v5/docs/framework/react/reference/useQuery) result object containing the list of transactions for the Safe account in the `data` property.
- The `data` property [format](https://github.com/safe-global/safe-core-sdk/blob/9fca59736c418dc6253404b4a7784e2245d83312/packages/api-kit/src/types/safeTransactionServiceTypes.ts#L212-L216)

#### Usage
{/* <!-- vale off --> */}

```typescript
import React from 'react';
import { useSafe } from '@safe-global/safe-core-sdk-react-hooks';

const Transactions = () => {
  const { getTransactions } = useSafe();
  const { data, error, isLoading } = getTransactions();

  if (isLoading) return <p>Loading...</p>;
  if (error) return <p>Error: {error.message}</p>;

  return (
    <div>
      <h3>Transactions</h3>
      <pre>{JSON.stringify(data, null, 2)}</pre>
    </div>
  );
};

export default Transactions;
```

{/* <!-- vale on --> */}

### `getSafeInfo`

`(params: UseSafeInfoParams = {}) => UseSafeInfoReturnType`

Get the connected Safe information.

#### Parameters
- `params` (UseSafeInfoParams, optional): Parameters to customize the hook behavior. It contains:
  - `config` (SafeConfig, optional): The [`SafeConfig`](./safeconfig.mdx) is used when a `SafeProvider` is not present in the component tree.

#### Returns
- A [query result](https://tanstack.com/query/v5/docs/framework/react/reference/useQuery) object containing the Safe account information in the `data` property.
- The `data` property [format](https://github.com/safe-global/safe-core-sdk-react-hooks/blob/6f620f2f9492d518af332cb7f21646beef4fb42f/src/types/index.ts#L32-L38)

#### Usage
{/* <!-- vale off --> */}

```typescript
import React from 'react';
import { useSafeInfo } from '@safe-global/safe-core-sdk-react-hooks';

const SafeInfo = () => {
  const { getSafeInfo } = useSafe();
  const { data, error, isLoading } = getSafeInfo();

  if (isLoading) return <p>Loading...</p>;
  if (error) return <p>Error: {error.message}</p>;

  return (
    <div>
      <h3>Safe Information</h3>
      <pre>{JSON.stringify(data, null, 2)}</pre>
    </div>
  );
};

export default SafeInfo;
```

{/* <!-- vale on --> */}

### `getSignerAddress`

`(params: UseSignerAddressParams = {}) => UseSignerAddressReturnType`

Get the configured signer address.

#### Parameters
- `params` (object, optional): Parameters to customize the hook behavior. It contains:
  - `config` (SafeConfig, optional): The [`SafeConfig`](./safeconfig.mdx) is used when a `SafeProvider` is not present in the component tree.

#### Returns
-  The signer address or `undefined` if not available.

#### Usage

{/* <!-- vale off --> */}

```typescript
import React from 'react';
import { useSafe } from '@safe-global/safe-core-sdk-react-hooks';

const SignerAddress = () => {
  const { getSignerAddress } = useSafe();
  const address = getSignerAddress();

  return (
    <div>
      <h3>Signer Address</h3>
      {address ? <pre>{address}</pre> : <p>No address available</p>}
    </div>
  );
};

export default SignerAddress;
```

{/* <!-- vale on --> */}

